<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Simulateur RCP + DEA 2D</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    background:#0b1c2d;
    color:white;
    font-family:Arial, sans-serif;
    text-align:center;
}

#instruction {
    background:#102a44;
    padding:15px;
    font-size:18px;
}

#scene {
    position:relative;
    width:300px;
    margin:20px auto;
}

#mannequin {
    width:100%;
}

.zone {
    position:absolute;
    cursor:pointer;
}

#epaules { top:90px; left:40px; width:220px; height:50px; }
#tete { top:20px; left:90px; width:120px; height:60px; }
#thorax { top:200px; left:80px; width:140px; height:120px; }
#bouche { top:70px; left:110px; width:80px; height:40px; }

#dea {
    display:none;
    margin-top:20px;
}

.electrode {
    width:60px;
    cursor:grab;
}

#zoneClavicule {
    position:absolute;
    top:180px;
    left:60px;
    width:80px;
    height:80px;
}

#zoneAxillaire {
    position:absolute;
    top:260px;
    left:160px;
    width:80px;
    height:80px;
}

#score {
    margin-top:20px;
    font-size:18px;
}
</style>
</head>

<body>

<div id="instruction">
Cliquez sur les épaules et parlez pour vérifier la conscience.
</div>

<div id="scene">
    <img id="mannequin" src="/mnt/data/0b8a7a17-d766-4540-ab97-b24e940d0179.png">

    <div id="epaules" class="zone"></div>
    <div id="tete" class="zone"></div>
    <div id="thorax" class="zone"></div>
    <div id="bouche" class="zone"></div>

    <div id="zoneClavicule"></div>
    <div id="zoneAxillaire"></div>
</div>

<div id="dea">
    <img src="https://asmsecourisme.com/wp-content/uploads/2017/09/AED-Zoll-AED-3-Semi-Automatic-1.png" width="200"><br>
    <img src="https://i.imgur.com/QfpuXdZ.png" class="electrode" draggable="true" id="elec1">
    <img src="https://i.imgur.com/NMdwaYQ.png" class="electrode" draggable="true" id="elec2"><br>
    <button id="shock">⚡ CHOC</button>
</div>

<div id="score"></div>

<script>
let step = 1;
let compressions = 0;
let insufflations = 0;

document.getElementById("epaules").onclick = () => {
    if(step!==1) return;
    step=2;
    instruction.innerText="Aucune réponse. Appelez à l’aide.";
};

document.getElementById("tete").onclick = () => {
    if(step!==2) return;
    step=3;
    instruction.innerText="Pas de respiration. Débutez les compressions.";
};

document.getElementById("thorax").onclick = () => {
    if(step!==3) return;
    compressions++;
    if(compressions===30){
        step=4;
        instruction.innerText="Effectuez 2 insufflations.";
    }
};

document.getElementById("bouche").onclick = () => {
    if(step!==4) return;
    insufflations++;
    if(insufflations===2){
        step=5;
        instruction.innerText="Appelez les secours. Le DEA arrive.";
        document.getElementById("dea").style.display="block";
    }
};

document.querySelectorAll(".electrode").forEach(e=>{
    e.ondragstart = ev => ev.dataTransfer.setData("id",ev.target.id);
});

["zoneClavicule","zoneAxillaire"].forEach(id=>{
    document.getElementById(id).ondragover = e=>e.preventDefault();
    document.getElementById(id).ondrop = e=>{
        e.preventDefault();
        e.target.style.border="2px solid lime";
    };
});

document.getElementById("shock").onclick = () => {
    instruction.innerText="Choc délivré. Reprenez la RCP.";
    score.innerHTML = `
    ✔ Compressions : ${compressions}<br>
    ✔ Insufflations : ${insufflations}<br>
    Simulation terminée
    `;
};
</script>

</body>
</html>
